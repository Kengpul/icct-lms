<% layout('layouts/lms-boilerplate') -%>

<nav class="navbar fixed-bottom navbar-light bg-white d-block d-lg-none">
  <div class="container-fluid">
    <a class="navbar-brand" href="#"><i class="fas fa-house-user"></i></a>
    <a class="navbar-brand" href="#"><i class="fas fa-users"></i></a>
    <a class="navbar-brand" href="#"><i class="fas fa-desktop"></i></a>
    <a class="navbar-brand" href="#"><i class="fas fa-list-alt"></i></a>
    <a class="navbar-brand" href="#"><i class="fas fa-briefcase"></i></a>
    <a class="navbar-brand" href="#"><i class="fas fa-comment-alt"></i></a>
  </div>
</nav>
<div class="container-fluid">
  <div class="row mt-3 d-flex justify-content-center justify-content-lg-start">
    <div class="col-0 col-lg-2 d-none d-lg-block side-nav text-white rounded h-100">
      <div class="profile mt-3 mb-5 text-center">
        <img
          src="/images/profile-picture.jpg"
          class="img-fluid"
          width="80"
          alt=""
        />
        <h5 class="mt-3">Hello <%= user.givenName %> </h5>
        <a href="/profile" class="link-light">View Profile</a>
      </div>
      <div class="d-grid gap-2 mb-5">
        <a href="/post" class="btn btn-primary active fw-bold text-start"
          ><i class="fas fa-house-user me-2 "></i>DASHBOARD</a
        >
        <a href="/class" class="btn btn-primary fw-bold text-start"
          ><i class="fas fa-users me-2"></i>MY CLASS</a
        >
        <a href="#" class="btn btn-primary fw-bold text-start"
          ><i class="fas fa-desktop me-2"></i>CLASSROOM</a
        >
        <a href="#" class="btn btn-primary fw-bold text-start"
          ><i class="fas fa-list-alt me-2"></i>PLANNER</a
        >
        <a href="#" class="btn btn-primary fw-bold text-start"
          ><i class="fas fa-briefcase me-2"></i>BACKPACK</a
        >
        <a href="#" class="btn btn-primary fw-bold text-start"
          ><i class="fas fa-comment-alt me-2"></i>MESSAGE</a
        >
      </div>
    </div>
    <div class="col col-lg-5 posts p-0 mx-2">
      <div class="bg-white p-3 rounded">
      <form action="/post" method="POST" class="validate" novalidate>
        <div class="form-floating">
          <textarea
            class="form-control posts-form"
            placeholder="Type your post here..."
            id="floatingTextarea2"
            name="text"
            required
          ></textarea>
          <label for="floatingTextarea2 fw-bold">Type your post here...</label>
        </div>
       <hr class="dropdown-divider" /></li>
       <div class="d-flex justify-content-end align-items-center mt-2">
        <select name="postTo" class="form-select" aria-label="Default select example" required>
          <% for (let _class of user.classes) { %>
          <option value="<%= _class._id %>"><%= _class.name %></option>
          <% } %> 
          <% for (let group of user.groups) { %>
            <option value="<%= group._id %>"><%= group.name %></option>
            <% } %> 
        </select>
          
         <button class="btn btn-primary ms-3 px-4">Post</button>
        </div>
      </form>
    </div>

    <% for (let classPost of classPosts) {%> 
      <a class="link-dark" href="/post/<%= classPost._id %> ">
      <div class="card mt-3">
        <div class="card-body">
          <div class="author d-flex align-items-center">
            <img src="images/user-image.png" class="img-fluid me-2" width="50" alt="">
            <h5 class="card-title fw-bold text-capitalize">
              <%= classPost.author.fullName %>
              <span class="text-muted">Posted to </span>
               <% if (classPost.class) {%>
                <%= classPost.class.name %>  
               <% }else { %> 
                <%= classPost.group.name %> 
               <% } %> 
          </h5>
          </div>
          <div class="card-text ms-5 fw-bold">
            <div class="text-muted"><%= classPost.author.type %></div>
            <div class="text-muted">Nov 18, 2022 10:11pm <i class="fas fa-users me-2"></i></div>
          </div>
          <div class="card-content mt-4">
            <div class="card-subtitle"><%= classPost.text %></div>
          </div>
        </div>
      </div>
    </a>
      <% } %> 

      <% for (let groupPost of groupPosts) {%> 
        <a class="link-dark" href="/post/<%= groupPost._id %> ">
        <div class="card mt-3">
          <div class="card-body">
            <div class="author d-flex align-items-center">
              <img src="images/user-image.png" class="img-fluid me-2" width="50" alt="">
              <h5 class="card-title fw-bold text-capitalize">
                <%= groupPost.author.fullName %>
                <span class="text-muted">Posted to </span>
                 <% if (groupPost.class) {%>
                  <%= groupPost.class.name %>  
                 <% }else { %> 
                  <%= groupPost.group.name %> 
                 <% } %> 
            </h5>
            </div>
            <div class="card-text ms-5 fw-bold">
              <div class="text-muted"><%= groupPost.author.type %></div>
              <div class="text-muted">Nov 18, 2022 10:11pm <i class="fas fa-users me-2"></i></div>
            </div>
            <div class="card-content mt-4">
              <div class="card-subtitle"><%= groupPost.text %></div>
            </div>
          </div>
        </div>
      </a>
        <% } %> 
    </div>

    <div class="col-4 col-lg-4 d-md-block d-none h-100">
      <div class="side-card bg-white h-50 overflow-hidden rounded">
        <div class="upcoming-header d-flex justify-content-between align-items-center pt-2 px-2">
          <h5 class="pt-2">UPCOMING</h5>
        </div>
        <hr class="dropdown-divider " /></li>
        <div class="upcoming">
          <div class="d-grid gap-2 ">
            <div class="d-flex justify-content-start align-items-center">
              <div>
                <i class="far fa-file-alt text-white bg-primary border p-2 rounded-circle px-2 mx-2"></i>
              </div>
              <div class="pt-3">
                <h6 class="fs-6">THS1 BSCS OL2216 PART 1 QUIZ</h6>
                <p class="text-danger">Due Date Dec 11</p>
              </div>
            </div>
            <div class="d-flex justify-content-start align-items-center">
              <div>
                <i class="far fa-file-alt text-white bg-primary border p-2 rounded-circle px-2 mx-2"></i>
              </div>
              <div class="pt-3">
                <h6 class="fs-6">THS1 BSCS OL2216 PART 2 QUIZ</h6>
                <p class="text-danger">Due Date Dec 12</p>
              </div>
            </div>
          </div>
        </div>
      </div> 
      <div class="side-card bg-white h-50 mt-2 pb-5 overflow-hidden rounded">
        <div class="my-classes-header d-flex justify-content-between align-items-center pt-2 px-2">
          <h5 class="pt-2">MY CLASSES</h5>
          <div class="dropdown">
            <button class="btn  dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="fas fa-ellipsis-v"></i>
            </button>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
              <% if (currentUser.type === 'Teacher') {%> 
              <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#createClassModal">Create a Class</a></li>
              <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#exampleModal">Join Class</a></li>
              <% } else { %> 
              <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#exampleModal">Join Class</a></li>
              <% } %> 
            </ul>
          </div>

          <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">Join Class</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form action="/class/join" method="POST" class="validate" novalidate>
                  <div class="modal-body">
                    <div class="form-floating">
                      <input type="text" class="form-control" name="code" id="Code" placeholder="Code" required>
                      <label for="Code">Code</label>
                    </div>
                  </div>
                  <div class="modal-footer">
                      <button type="submit" class="btn btn-primary px-4">Join</button>
                  </div>
              </form>
              </div>
            </div>
          </div>
          
          <div class="modal fade" id="createClassModal" tabindex="-1" aria-labelledby="createClassLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="createClassLabel">Create a Class</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form action="/class" method="POST" class="validate" novalidate>
                  <div class="modal-body">
                    <div class="form-floating mb-3">
                      <input
                        type="text"
                        class="form-control"
                        name="name"
                        id="name"
                        placeholder="Name"
                        required
                      />
                      <label for="name">Name of the class</label>
                    </div>
                    <div class="form-floating">
                      <input
                        type="text"
                        class="form-control"
                        name="code"
                        id="code"
                        placeholder="code"
                        required
                      />
                      <label for="code">Code of the class</label>
                    </div>
                  </div>
                  <div class="modal-footer">
                      <button type="submit" class="btn btn-primary px-4">Create</button>
                  </div>
              </form>
              </div>
            </div>
          </div>
        </div>
        <hr class="dropdown-divider " /></li>
        <div class="classes">
          <div class="d-grid gap-2 mt-4">
            <% for (let _class of user.classes) { %>
              <div class="border-start border-danger border-3 px-2 ms-2"><a href="/class/<%= _class._id %>"><%= _class.name %> </a></div>
            <% } %> 
          </div>
        </div>
      </div>

      <div class="side-card bg-white h-50 mt-2 pb-5 overflow-hidden rounded">
        <div class="my-classes-header d-flex justify-content-between align-items-center pt-2 px-2">
          <h5 class="pt-2">MY GROUPS</h5>
          <div class="dropdown">
            <button class="btn  dropdown-toggle" type="button" id="dropdownMenuGroupButton" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="fas fa-ellipsis-v"></i>
            </button>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenuGroupButton">
              <% if (currentUser.type === 'Teacher') {%> 
              <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#createGroupModal">Create Group</a></li>
              <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#groupModal">Join Group</a></li>
              <% } else { %> 
              <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#groupModal">Join Group</a></li>
              <% } %> 
            </ul>
          </div>

          <div class="modal fade" id="groupModal" tabindex="-1" aria-labelledby="GroupModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="GroupModalLabel">Join Class</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form action="/group/join" method="POST" class="validate" novalidate>
                  <div class="modal-body">
                    <div class="form-floating">
                      <input type="text" class="form-control" name="code" id="Code" placeholder="Code" required>
                      <label for="Code">Code</label>
                    </div>
                  </div>
                  <div class="modal-footer">
                      <button type="submit" class="btn btn-primary px-4">Join</button>
                  </div>
              </form>
              </div>
            </div>
          </div>
          
          <div class="modal fade" id="createGroupModal" tabindex="-1" aria-labelledby="createGroupLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="createGroupLabel">Create Group</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form action="/group" method="POST" class="validate" novalidate>
                  <div class="modal-body">
                    <div class="form-floating mb-3">
                      <input
                        type="text"
                        class="form-control"
                        name="name"
                        id="name"
                        placeholder="Name"
                        required
                      />
                      <label for="name">Name of the group</label>
                    </div>
                    <div class="form-floating">
                      <input
                        type="text"
                        class="form-control"
                        name="code"
                        id="code"
                        placeholder="code"
                        required
                      />
                      <label for="code">Code of the group</label>
                    </div>
                  </div>
                  <div class="modal-footer">
                      <button type="submit" class="btn btn-primary px-4">Create</button>
                  </div>
              </form>
              </div>
            </div>
          </div>
        </div>
        <hr class="dropdown-divider " /></li>
        <div class="classes">
          <div class="d-grid gap-2 mt-4">
            <% for (let group of user.groups) { %>
              <div class="border-start border-danger border-3 px-2 ms-2"><a href="/group/<%= group._id %>"><%= group.name %></a></div>
            <% } %> 
          </div>
        </div>
      </div>

      <div class="side-card bg-white h-50 mt-2 pb-3 rounded">
        <div class="materials-header d-flex justify-content-between align-items-center pt-2 px-2">
          <h5 class="pt-2">MATERIALS</h5>
        </div>
        <hr class="dropdown-divider " /></li>
        <div class="materials">
          <div class="d-grid gap-2 mt-4">
            <div class="border-start border-primary border-3 px-2 ms-2"><i class="fas fa-file-pdf"></i> OS1.pdf</div>
            <div class="border-start border-secondary border-3 px-2 ms-2"><i class="fas fa-file-pdf"></i> PL1.pdf</div>
            <div class="border-start border-info border-3 px-2 ms-2"><i class="fas fa-file-pdf"></i> THS1.pdf</div>
            <div class="border-start border-danger border-3 px-2 ms-2"><i class="fas fa-file-pdf"></i> SE1.pdf</div>
          </div>
        </div>
      </div> 
    </div>
  </div>
</div>
